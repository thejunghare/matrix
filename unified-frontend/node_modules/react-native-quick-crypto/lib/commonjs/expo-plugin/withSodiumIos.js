"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.withSodiumIos = void 0;
var _configPlugins = require("expo/config-plugins");
var _fs = _interopRequireDefault(require("fs"));
var _path = _interopRequireDefault(require("path"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
const withSodiumIos = config => {
  return (0, _configPlugins.withDangerousMod)(config, ['ios', config => {
    const podfilePath = _path.default.join(config.modRequest.platformProjectRoot, 'Podfile');
    let contents = _fs.default.readFileSync(podfilePath, 'utf-8');

    // Check if SODIUM_ENABLED is already set
    if (!contents.includes("ENV['SODIUM_ENABLED']")) {
      // Add it right after the RCT_NEW_ARCH_ENABLED ENV variable
      contents = contents.replace(/^(ENV\['RCT_NEW_ARCH_ENABLED'\].*$)/m, `$1\nENV['SODIUM_ENABLED'] = '1'`);
      _fs.default.writeFileSync(podfilePath, contents);
    }
    return config;
  }]);
};
exports.withSodiumIos = withSodiumIos;
//# sourceMappingURL=withSodiumIos.js.map